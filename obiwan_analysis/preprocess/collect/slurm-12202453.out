I am  nid03652 rank 44 (total 240)
34 34
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 46 (total 240)
31 31
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 36 (total 240)
40 40
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 38 (total 240)
38 38
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 40 (total 240)
39 39
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 42 (total 240)
44 44
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 28 (total 240)
33 33
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 30 (total 240)
44 44
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 41 (total 240)
46 46
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 43 (total 240)
29 29
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 37 (total 240)
45 45
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 39 (total 240)
47 47
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 32 (total 240)
40 40
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 34 (total 240)
41 41
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 45 (total 240)
25 25
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 29 (total 240)
42 42
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 33 (total 240)
45 45
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 35 (total 240)
37 37
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 31 (total 240)
38 38
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 47 (total 240)
38 38
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 25 (total 240)
34 34
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 27 (total 240)
39 39
I am  nid03652 rank 26 (total 240)
25 25
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 24 (total 240)
30 30
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:46: RuntimeWarning: invalid value encountered in subtract
  rz = r_mag - z_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 9 (total 240)
47 47
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 14 (total 240)
44 44
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 10 (total 240)
46 46
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03652 rank 22 (total 240)
50 50
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 1 (total 240)
36 36
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 20 (total 240)
37 37
I am  nid03652 rank 11 (total 240)
47 47
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 23 (total 240)
35 35
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 12 (total 240)
29 29
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03652 rank 3 (total 240)
43 43
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
I am  nid03652 rank 21 (total 240)
35 35
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 4 (total 240)
33 33
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 6 (total 240)
47 47
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 15 (total 240)
26 26
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 7 (total 240)
46 46
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 64 (total 240)
45 45
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 144 (total 240)
41 41
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03652 rank 16 (total 240)
44 44
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
I am  nid03652 rank 18 (total 240)
34 34
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
I am  nid03652 rank 5 (total 240)
37 37
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 8 (total 240)
42 42
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
I am  nid03652 rank 13 (total 240)
40 40
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03652 rank 17 (total 240)
33 33
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03652 rank 19 (total 240)
43 43
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
I am  nid03652 rank 2 (total 240)
42 42
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 87 (total 240)
50 50
I am  nid03653 rank 74 (total 240)
25 25
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 51 (total 240)
43 43
I am  nid03653 rank 94 (total 240)
41 41
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03653 rank 93 (total 240)
50 50
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 56 (total 240)
34 34
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 67 (total 240)
30 30
I am  nid03653 rank 77 (total 240)
34 34
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 62 (total 240)
26 26
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 57 (total 240)
60 60
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 53 (total 240)
46 46
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 90 (total 240)
45 45
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03653 rank 68 (total 240)
36 36
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03653 rank 82 (total 240)
55 55
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 71 (total 240)
39 39
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 84 (total 240)
45 45
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 69 (total 240)
32 32
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
I am  nid03653 rank 81 (total 240)
46 46
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03653 rank 86 (total 240)
37 37
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 192 (total 240)
38 38
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 48 (total 240)
52 52
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03653 rank 65 (total 240)
42 42
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 59 (total 240)
35 35
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 60 (total 240)
40 40
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03653 rank 88 (total 240)
33 33
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 70 (total 240)
29 29
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 49 (total 240)
45 45
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03653 rank 75 (total 240)
32 32
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 92 (total 240)
38 38
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 52 (total 240)
33 33
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03653 rank 58 (total 240)
41 41
I am  nid03653 rank 85 (total 240)
32 32
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03653 rank 76 (total 240)
20 20
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 78 (total 240)
37 37
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 50 (total 240)
34 34
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03653 rank 79 (total 240)
41 41
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 55 (total 240)
50 50
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 95 (total 240)
42 42
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 72 (total 240)
37 37
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 80 (total 240)
46 46
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 61 (total 240)
42 42
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03653 rank 91 (total 240)
37 37
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 66 (total 240)
31 31
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 128 (total 240)
29 29
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 96 (total 240)
41 41
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 54 (total 240)
35 35
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 73 (total 240)
38 38
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 63 (total 240)
42 42
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 89 (total 240)
38 38
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03653 rank 83 (total 240)
25 25
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 166 (total 240)
38 38
I am  nid03655 rank 151 (total 240)
34 34
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 190 (total 240)
42 42
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 170 (total 240)
33 33
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 156 (total 240)
39 39
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 171 (total 240)
47 47
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 167 (total 240)
37 37
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 174 (total 240)
47 47
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 159 (total 240)
53 53
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 162 (total 240)
36 36
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 150 (total 240)
35 35
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03655 rank 152 (total 240)
28 28
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 163 (total 240)
26 26
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 177 (total 240)
29 29
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 191 (total 240)
35 35
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 180 (total 240)
43 43
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 182 (total 240)
41 41
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 176 (total 240)
31 31
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 178 (total 240)
27 27
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 148 (total 240)
22 22
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 153 (total 240)
37 37
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 172 (total 240)
42 42
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 161 (total 240)
34 34
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 145 (total 240)
41 41
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 154 (total 240)
41 41
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 189 (total 240)
34 34
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 147 (total 240)
36 36
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03655 rank 187 (total 240)
34 34
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 155 (total 240)
41 41
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 185 (total 240)
29 29
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 184 (total 240)
22 22
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 157 (total 240)
32 32
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 160 (total 240)
39 39
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 179 (total 240)
35 35
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 169 (total 240)
35 35
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 183 (total 240)
27 27
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 158 (total 240)
28 28
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 188 (total 240)
38 38
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 173 (total 240)
34 34
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 165 (total 240)
37 37
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03655 rank 181 (total 240)
42 42
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 186 (total 240)
45 45
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 168 (total 240)
46 46
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 149 (total 240)
41 41
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 175 (total 240)
42 42
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 164 (total 240)
46 46
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03655 rank 146 (total 240)
40 40
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:46: RuntimeWarning: invalid value encountered in subtract
  rz = r_mag - z_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 234 (total 240)
9 9
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 200 (total 240)
43 43
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 222 (total 240)
34 34
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 236 (total 240)
30 30
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 216 (total 240)
26 26
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 205 (total 240)
21 21
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 239 (total 240)
33 33
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 196 (total 240)
30 30
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 214 (total 240)
38 38
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 208 (total 240)
36 36
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 194 (total 240)
30 30
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 233 (total 240)
34 34
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 193 (total 240)
45 45
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 228 (total 240)
38 38
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 221 (total 240)
42 42
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03656 rank 199 (total 240)
40 40
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 212 (total 240)
42 42
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 219 (total 240)
33 33
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 204 (total 240)
50 50
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 223 (total 240)
43 43
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 197 (total 240)
33 33
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 217 (total 240)
36 36
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03656 rank 231 (total 240)
32 32
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03656 rank 209 (total 240)
28 28
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 235 (total 240)
40 40
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 229 (total 240)
35 35
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03656 rank 213 (total 240)
39 39
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03656 rank 220 (total 240)
34 34
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 232 (total 240)
35 35
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 215 (total 240)
36 36
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 230 (total 240)
36 36
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 202 (total 240)
33 33
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 210 (total 240)
43 43
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 211 (total 240)
33 33
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 237 (total 240)
42 42
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 195 (total 240)
44 44
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 198 (total 240)
37 37
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 238 (total 240)
57 57
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:46: RuntimeWarning: invalid value encountered in subtract
  rz = r_mag - z_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 207 (total 240)
38 38
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 227 (total 240)
40 40
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:46: RuntimeWarning: invalid value encountered in subtract
  rz = r_mag - z_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 206 (total 240)
38 38
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 226 (total 240)
25 25
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 225 (total 240)
35 35
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 224 (total 240)
26 26
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 218 (total 240)
27 27
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03656 rank 203 (total 240)
25 25
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03656 rank 201 (total 240)
35 35
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 140 (total 240)
32 32
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 110 (total 240)
42 42
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 134 (total 240)
36 36
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 133 (total 240)
40 40
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 112 (total 240)
38 38
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 143 (total 240)
41 41
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 106 (total 240)
39 39
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 99 (total 240)
38 38
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03654 rank 118 (total 240)
44 44
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 104 (total 240)
38 38
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 97 (total 240)
38 38
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 116 (total 240)
40 40
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 123 (total 240)
37 37
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 138 (total 240)
31 31
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 107 (total 240)
24 24
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 120 (total 240)
28 28
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 119 (total 240)
32 32
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 121 (total 240)
33 33
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 125 (total 240)
41 41
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 115 (total 240)
32 32
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 103 (total 240)
35 35
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 105 (total 240)
42 42
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 102 (total 240)
31 31
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 141 (total 240)
34 34
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 114 (total 240)
33 33
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:46: RuntimeWarning: invalid value encountered in subtract
  rz = r_mag - z_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 100 (total 240)
50 50
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 139 (total 240)
34 34
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 130 (total 240)
45 45
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03654 rank 129 (total 240)
38 38
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 131 (total 240)
51 51
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:46: RuntimeWarning: invalid value encountered in subtract
  rz = r_mag - z_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 101 (total 240)
34 34
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:46: RuntimeWarning: invalid value encountered in subtract
  rz = r_mag - z_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 137 (total 240)
48 48
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03654 rank 109 (total 240)
10 10
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:46: RuntimeWarning: invalid value encountered in subtract
  rz = r_mag - z_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 136 (total 240)
20 20
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 111 (total 240)
32 32
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 127 (total 240)
37 37
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 122 (total 240)
42 42
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 113 (total 240)
39 39
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 117 (total 240)
31 31
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 142 (total 240)
42 42
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:46: RuntimeWarning: invalid value encountered in subtract
  rz = r_mag - z_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 108 (total 240)
37 37
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 135 (total 240)
47 47
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 132 (total 240)
45 45
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid03654 rank 124 (total 240)
38 38
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 126 (total 240)
29 29
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid03654 rank 98 (total 240)
45 45
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** STEP 12202453.0 ON nid03652 CANCELLED AT 2019-02-06T19:27:59 DUE TO TIME LIMIT ***
srun: got SIGCONT
srun: forcing job termination
