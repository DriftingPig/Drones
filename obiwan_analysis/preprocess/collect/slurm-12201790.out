I am  nid02857 rank 64 (total 96)
30 30
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 48 (total 96)
34 34
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid02856 rank 30 (total 96)
25 25
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 44 (total 96)
39 39
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 46 (total 96)
44 44
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 41 (total 96)
45 45
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 43 (total 96)
47 47
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 40 (total 96)
40 40
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 42 (total 96)
38 38
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 36 (total 96)
40 40
I am  nid02856 rank 38 (total 96)
41 41
I am  nid02856 rank 37 (total 96)
45 45
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 39 (total 96)
37 37
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 29 (total 96)
34 34
I am  nid02856 rank 31 (total 96)
39 39
I am  nid02856 rank 33 (total 96)
42 42
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 35 (total 96)
38 38
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 32 (total 96)
33 33
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 34 (total 96)
44 44
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 45 (total 96)
46 46
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 47 (total 96)
29 29
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 28 (total 96)
45 45
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
I am  nid02857 rank 62 (total 96)
52 52
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 8 (total 96)
37 37
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
I am  nid02857 rank 70 (total 96)
46 46
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
I am  nid02857 rank 86 (total 96)
34 34
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid02857 rank 69 (total 96)
43 43
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid02856 rank 12 (total 96)
47 47
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:46: RuntimeWarning: invalid value encountered in subtract
  rz = r_mag - z_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 16 (total 96)
40 40
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 13 (total 96)
46 46
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid02856 rank 3 (total 96)
38 38
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 9 (total 96)
47 47
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 19 (total 96)
44 44
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 11 (total 96)
42 42
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 26 (total 96)
35 35
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 27 (total 96)
41 41
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 17 (total 96)
44 44
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 1 (total 96)
25 25
I am  nid02856 rank 15 (total 96)
29 29
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 24 (total 96)
35 35
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 10 (total 96)
46 46
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 23 (total 96)
37 37
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 18 (total 96)
26 26
I am  nid02856 rank 14 (total 96)
47 47
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 25 (total 96)
50 50
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid02856 rank 21 (total 96)
34 34
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 5 (total 96)
42 42
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 7 (total 96)
33 33
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 20 (total 96)
33 33
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid02856 rank 22 (total 96)
43 43
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 2 (total 96)
31 31
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 6 (total 96)
43 43
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02856 rank 4 (total 96)
36 36
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
I am  nid02857 rank 85 (total 96)
30 30
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 76 (total 96)
60 60
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 80 (total 96)
26 26
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 82 (total 96)
38 38
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 94 (total 96)
32 32
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 92 (total 96)
36 36
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 66 (total 96)
39 39
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 87 (total 96)
25 25
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 67 (total 96)
34 34
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 81 (total 96)
46 46
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 88 (total 96)
55 55
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 83 (total 96)
45 45
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 75 (total 96)
37 37
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 72 (total 96)
50 50
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 93 (total 96)
45 45
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 89 (total 96)
50 50
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 52 (total 96)
41 41
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: divide by zero encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: divide by zero encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:45: RuntimeWarning: invalid value encountered in subtract
  gr = g - r_mag
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 54 (total 96)
42 42
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 78 (total 96)
29 29
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 49 (total 96)
32 32
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 59 (total 96)
20 20
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 55 (total 96)
37 37
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 68 (total 96)
38 38
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 58 (total 96)
45 45
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 51 (total 96)
34 34
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 65 (total 96)
33 33
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 95 (total 96)
32 32
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 53 (total 96)
33 33
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: divide by zero encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 63 (total 96)
41 41
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 73 (total 96)
35 35
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 74 (total 96)
40 40
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 56 (total 96)
37 37
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 57 (total 96)
41 41
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 79 (total 96)
46 46
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 61 (total 96)
50 50
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 60 (total 96)
42 42
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 77 (total 96)
41 41
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 90 (total 96)
29 29
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 84 (total 96)
31 31
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 91 (total 96)
25 25
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 71 (total 96)
37 37
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:42: RuntimeWarning: invalid value encountered in log10
  g     = 22.5 - 2.5 * n.log10(dat['flux_g'] / dat['mw_transmission_g'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:43: RuntimeWarning: invalid value encountered in log10
  r_mag = 22.5 - 2.5 * n.log10(dat['flux_r'] / dat['mw_transmission_r'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:44: RuntimeWarning: invalid value encountered in log10
  z_mag = 22.5 - 2.5 * n.log10(dat['flux_z'] / dat['mw_transmission_z'])
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in greater
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:47: RuntimeWarning: invalid value encountered in less
  color_sgc = (g>21.825)&(g<22.825)&(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.218*gr+0.571<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in greater
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py:48: RuntimeWarning: invalid value encountered in less
  color_ngc = (g>21.825)&(g<22.9)  &(-0.068*rz+0.457<gr)&(gr< 0.112*rz+0.773) &(0.637*gr+0.399<rz)&(rz<-0.555*gr+1.901)
I am  nid02857 rank 50 (total 96)
42 42
Traceback (most recent call last):
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1958, in _get_index
    indx = names.index(key.rstrip())
ValueError: 'shapeexp_r,' is not in list

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "collect_mpi.py", line 111, in <module>
    main()
  File "collect_mpi.py", line 106, in main
    MySlave().run()
  File "/global/cscratch1/sd/huikong/obiwan_Aug/repos_for_docker/obiwan_code/py/obiwan/Drones/py/mpi_master_slave/master_slave.py", line 143, in run
    result = self.do_work(data)
  File "collect_mpi.py", line 86, in do_work
    tab = ELG_match(task)
  File "/global/u2/h/huikong/obiwan_codes/obiwan_Aug/obiwan_code/py/obiwan/Drones/obiwan_analysis/preprocess/collect/collect.py", line 120, in ELG_match
    tab = Table([mtc['ra'],mtc['dec'],mtc['flux_z'],mtc['mw_transmission_z'],msim['z'],mtc['flux_g'],mtc['mw_transmission_g'],msim['g'],mtc['flux_r'],mtc['mw_transmission_r'],msim['r'],msim['nn_redshift'],brickname_array,angdis,msim['n'],mtc['fracdev'],mtc['shapeexp_r,'],mtc['shapedev_r']],names=('ra','dec','flux_z','mw_transmission_z','z','flux_g','mw_transmission_g','g','flux_r','mw_transmission_r','r','nn_redshift','brickname','angdis','n','fracdev','shapeexp_r','shapedev_r'))
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 487, in __getitem__
    return self.field(key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/fitsrec.py", line 677, in field
    column = self.columns[key]
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1565, in __getitem__
    key = _get_index(self.names, key)
  File "/global/common/edison/software/python/3.6-anaconda-5.2/lib/python3.6/site-packages/astropy/io/fits/column.py", line 1967, in _get_index
    raise KeyError("Key '{}' does not exist.".format(key))
KeyError: "Key 'shapeexp_r,' does not exist."
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** STEP 12201790.0 ON nid02856 CANCELLED AT 2019-02-06T18:49:25 DUE TO TIME LIMIT ***
srun: got SIGCONT
srun: forcing job termination
srun: forcing job termination
